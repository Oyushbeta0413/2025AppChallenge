<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login / Signup - CTRL + ALT + HEAL</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Firebase JS SDK -->
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js';
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, sendPasswordResetEmail } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js';
    import { getFirestore, doc, setDoc } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js';

    const firebaseConfig = {
      apiKey: "",
      authDomain: "",
      projectId: "",
      storageBucket: "",
      messagingSenderId: "",
      appId: "",
      measurementId: ""
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    window.toggleMode = (mode) => {
      document.getElementById('formTitle').textContent = mode === 'signup' ? 'Sign Up' : 'Log In';
      document.getElementById('nameGroup').style.display = mode === 'signup' ? 'block' : 'none';
      document.getElementById('dobGroup').style.display = mode === 'signup' ? 'block' : 'none';
      document.getElementById('submitBtn').textContent = mode === 'signup' ? 'Sign Up' : 'Log In';
      document.getElementById('mode').value = mode;
    };

    window.submitForm = async () => {
      const mode = document.getElementById('mode').value;
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      try {
        if (mode === 'signup') {
          const name = document.getElementById('name').value;
          const dob = document.getElementById('dob').value;
          const userCredential = await createUserWithEmailAndPassword(auth, email, password);
          const user = userCredential.user;
          await setDoc(doc(db, 'users', user.uid), { name, email, dob });
        } else {
          await signInWithEmailAndPassword(auth, email, password);
        }
        window.location.href = 'profile.html';
      } catch (err) {
        alert((mode === 'signup' ? 'Sign Up' : 'Log In') + ' error: ' + err.message);
      }
    };

    window.resetPassword = async () => {
      const email = document.getElementById('email').value;
      if (!email) return alert('Please enter your email to reset password.');
      try {
        await sendPasswordResetEmail(auth, email);
        alert('Password reset email sent to ' + email);
      } catch (err) {
        alert('Error sending password reset: ' + err.message);
      }
    };

    document.addEventListener('DOMContentLoaded', () => {
      toggleMode('login');
    });
  </script>
</head>
<body class="bg-[#F7F8F9] min-h-screen">
  <nav class="bg-white shadow px-6 py-4">
    <div class="container mx-auto flex justify-between items-center">
      <a href="index.html" class="text-xl font-bold text-[#6B9080]">CTRL + ALT + HEAL</a>
      <ul class="flex space-x-6 text-sm font-medium text-gray-700">
        <li><a href="index.html" class="hover:text-[#6B9080]">Home</a></li>
        <li><a href="analyzer.html" class="hover:text-[#6B9080]">Analyzer</a></li>
        <li><a href="profile.html" class="hover:text-[#6B9080]">Profile</a></li>
        <li><a href="login.html" class="hover:text-[#6B9080]">Login</a></li>
        <li><a href="about.html" class="hover:text-[#6B9080]">About Us</a></li>
      </ul>
    </div>
  </nav>

  <div class="flex items-center justify-center mt-12">
    <div class="bg-white p-8 rounded shadow-md w-full max-w-md">
      <h2 id="formTitle" class="text-2xl font-semibold text-[#6B9080] mb-6">Log In</h2>
      <input type="hidden" id="mode" value="login">

      <label class="block mb-2 text-sm font-medium">Mode</label>
      <select id="modeSelector" onchange="toggleMode(this.value)" class="w-full mb-4 px-4 py-2 border rounded">
        <option value="login">Log In</option>
        <option value="signup">Sign Up</option>
      </select>

      <label class="block mb-2 text-sm font-medium">Email</label>
      <input type="email" id="email" placeholder="you@example.com" class="w-full mb-4 px-4 py-2 border rounded" />

      <label class="block mb-2 text-sm font-medium">Password</label>
      <input type="password" id="password" placeholder="••••••••" class="w-full mb-4 px-4 py-2 border rounded" />

      <div id="nameGroup" style="display:none;">
        <label class="block mb-2 text-sm font-medium">Name</label>
        <input type="text" id="name" placeholder="Your Name" class="w-full mb-4 px-4 py-2 border rounded" />
      </div>

      <div id="dobGroup" style="display:none;">
        <label class="block mb-2 text-sm font-medium">Date of Birth</label>
        <input type="date" id="dob" class="w-full mb-6 px-4 py-2 border rounded" />
      </div>

      <button onclick="submitForm()" id="submitBtn" class="w-full bg-[#6B9080] text-white py-2 rounded hover:bg-[#5B7A6F] mb-2">Log In</button>
      <button onclick="resetPassword()" class="w-full bg-red-500 text-white py-2 rounded hover:bg-red-600">Reset Password</button>
    </div>
  </div>
</body>
</html>
